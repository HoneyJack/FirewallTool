<div class="row-fluid">
  <h3 class="summary-title">Policies</h3>
  <div class="span12">
    <table class="table table-bordered table-condensed rule-policy policy" style="margin-bottom: 0px;">
      <thead>
      <tr>
        <th>Table</th>
        <th>Chain</th>
        <th>Action</th>
      </tr>
      </thead>
      <tbody id="all-code-policies">
      <% policies.each_with_index do |rule, i| %>
          <tr data-order="<%= i+1 %>">
            <td><%= rule.table %></td>
            <td><%= rule.chain %></td>
            <td><%= rule.job %></td>
          </tr>
      <% end %>
      </tbody>
    </table>
  </div>
  <h3 class="summary-title">Rules</h3>
  <div class="span12">
    <table class="table table-bordered table-condensed rule-policy rule" style="margin-bottom: 0px;">
      <thead>
      <tr>
        <th>Table</th>
        <th>Chain</th>
        <th>Interface I/O</th>
        <th>Ip S/D</th>
        <th>Protocol</th>
        <th>Port S/D</th>
        <th>Connection State</th>
        <th>Action</th>
        <th>Nat ip/mask</th>
      </tr>
      </thead>
      <tbody id="all-code-rules">
      <% rules.each_with_index do |rule, i| %>
          <tr data-order="<%= i+1 %>">
            <td><%= rule.table %></td>
            <td><%= rule.chain %></td>
            <td>
                <table>
                  <tr>
                    <td><%= rule.input_device %></td>
                  </tr>
                  <tr>
                    <td><%= rule.output_device %></td>
                  </tr>
                </table>
            </td>
            <td>
              <table>
                <tr>
                  <td><%= rule.source_ip %></td>
                </tr>
                <tr>
                  <td><%= rule.destination_ip %></td>
                </tr>
              </table>
            </td>
            <td><%= rule.protocol.humanize %></td>
            <td>
              <table>
                <tr>
                  <td><%= rule.source_port %></td>
                </tr>
                <tr>
                  <td><%= rule.destination_port %></td>
                </tr>
              </table>
            </td>
            <td>
              <% rule.connection_states.each do |connection_state| %>
                  <p class="no-margin"><%= connection_state %></p>
              <% end %>
            </td>
            <td><%= rule.job %></td>
            <td>
              <table>
                <tr>
                  <td><%= rule.nat_action_ip %></td>
                </tr>
                <tr>
                  <td><%= rule.nat_action_mask %></td>
                </tr>
              </table>
            </td>

          </tr>
      <% end %>
      </tbody>
    </table>
  </div>
  <div class="row-fluid" id="div-button-download">
    <div class="span12 text-right">
      <%= link_to "Download script", download_script_iptables_rule_path(firewall.id), id: "download_script", class: "btn btn-success" %>
    </div>
  </div>
</div>

